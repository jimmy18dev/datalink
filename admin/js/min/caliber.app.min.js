function caliberList(t){var a="api.caliber.php",e="";$("#caliber_list").html('<div class="loading"><i class="fa fa-spinner fa-spin" aria-hidden="true"></i>Loading...</div>'),$.ajax({url:a,cache:!1,dataType:"json",type:"GET",data:{calling:"caliber",action:"list_caliber",keyword:t},error:function(){console.log("Request Error")}}).done(function(t){console.log(t),$.each(t.data.items,function(t,a){e+='<div class="box-items caliber-items" data-id="'+a.caliber_id+'">',e+='<div class="detail">',e+='<div class="name">'+a.caliber_code+" "+a.caliber_family+"</div>",e+='<div class="info"><strong>Stdtime</strong> '+a.caliber_stdtime+" Hrs/K Â· <strong>Route</strong> "+a.route_name+"</div>",e+="</div>",e+='<div class="btn btn-caliber-edit">Edit</div>',"active"!=a.caliber_status&&(e+='<div class="btn enable btn-caliber-enable">Enable</div>'),e+="</div>"}),$("#caliber_list").html(e),e=""}).error()}function routeList(t){var a="api.caliber.php",e="";$.ajax({url:a,cache:!1,dataType:"json",type:"GET",data:{calling:"caliber",action:"list_route",caliber_id:t},error:function(){console.log("Request Error")}}).done(function(t){console.log(t),$.each(t.data.items,function(t,a){e+='<div class="box-items route-items" data-id="'+a.route_id+'">',e+='<div class="detail">',e+='<div class="name">'+a.route_name+"</div>",e+='<div class="info"><strong>Operation</strong> '+a.route_total_operation+"</div>",e+="</div>",e+='<div class="btn btn-route-edit">Edit</div>',"primary"!=a.route_type&&(e+='<div class="btn enable btn-route-enable">Primary</div>'),e+="</div>"}),$("#route_list").html(e),e=""}).error()}function operationList(t){var a="api.caliber.php",e="";$.ajax({url:a,cache:!1,dataType:"json",type:"GET",data:{calling:"caliber",action:"list_operation",route_id:t},error:function(){console.log("Request Error")}}).done(function(t){console.log(t),$.each(t.data.items,function(t,a){null==a.operation_match_id?(e+='<div class="box-items operation-items -disable" data-id="'+a.operation_id+'">',e+='<div class="detail"><div class="name">'+a.operation_name+'</div><div class="info">Operation ID '+a.operation_id+"</div></div>",e+='<div class="btn btn-operation-edit">Edit</div>',e+='<div class="btn enable btn-operation-matching">Add</div>',e+="</div>"):(e+='<div class="box-items operation-items" data-id="'+a.operation_id+'">',e+='<div class="detail"><div class="name">'+a.operation_sort+". "+a.operation_name+" "+a.operation_match_id+'</div><div class="info">Operation ID '+a.operation_id+"</div></div>",e+='<div class="btn btn-operation-edit">Edit</div>',e+='<div class="btn btn-operation-unmatch">Remove</div>',e+="</div>")}),$("#operation_list").html(e),e=""}).error()}var api_caliber="api.caliber.php",api_route="api.route.php",api_operation="api.operation.php";$(document).ready(function(){function t(){$dialogCaliber.fadeOut(300),$filterCaliber.fadeOut(100),$("#caliber_code").val(""),$("#caliber_family").val(""),$("#caliber_description").val(""),$("#caliber_stdtime").val("")}function a(){$dialogRoute.fadeOut(300),$filterRoute.fadeOut(100),$("#route_name").val(""),$("#route_description").val("")}function e(){$dialogOperation.fadeOut(300),$filterOperation.fadeOut(100),$("#operation_name").val(""),$("#operation_description").val("")}var i,o,n,r;$dialogCaliber=$("#dialogCaliber"),$filterCaliber=$("#filterCaliber"),$btnCreateCaliber=$("#btnCreateCaliber"),$btnCloseCaliber=$("#btnCloseCaliber"),$btnSubmitCaliber=$("#btnSubmitCaliber"),$btnCreateCaliber.click(function(){$dialogCaliber.fadeIn(300),$filterCaliber.fadeIn(100),$btnSubmitCaliber.html("Create")}),$btnCloseCaliber.click(function(){t()}),$btnSubmitCaliber.click(function(){var a=$("#caliber_id").val(),e=$("#caliber_code").val(),i=$("#caliber_family").val(),o=$("#caliber_description").val(),n=$("#caliber_stdtime").val();$.ajax({url:api_caliber,cache:!1,dataType:"json",type:"POST",data:{calling:"caliber",action:"submit",id:a,code:e,description:o,family:i,stdtime:n},error:function(t){console.log(t.responseText)}}).done(function(a){console.log(a),t(),caliberList("")})}),$btnCreateRoute=$("#btnCreateRoute"),$dialogRoute=$("#dialogRoute"),$btnCloseRoute=$("#btnCloseRoute"),$btnSubmitRoute=$("#btnSubmitRoute"),$filterRoute=$("#filterRoute"),$btnCreateRoute.click(function(){$btnSubmitRoute.html("Create"),$dialogRoute.fadeIn(300),$filterRoute.fadeIn(100)}),$btnCloseRoute.click(function(){a()}),$btnSubmitRoute.click(function(){var t=$("#route_id").val(),e=$("#route_name").val(),o=$("#route_description").val();$.ajax({url:api_route,cache:!1,dataType:"json",type:"POST",data:{calling:"route",action:"submit",id:t,name:e,description:o,caliber_id:i},error:function(){console.log("Request Error")}}).done(function(t){console.log(t),a(),routeList(i)})}),$btnCreateOperation=$("#btnCreateOperation"),$dialogOperation=$("#dialogOperation"),$btnCloseOperation=$("#btnCloseOperation"),$btnSubmitOperation=$("#btnSubmitOperation"),$filterOperation=$("#filterOperation"),$btnCreateOperation.click(function(){$btnSubmitOperation.html("Create"),$dialogOperation.fadeIn(300),$filterOperation.fadeIn(100)}),$btnCloseOperation.click(function(){e()}),$btnSubmitOperation.click(function(){var t=$("#operation_id").val(),a=$("#operation_name").val(),i=$("#operation_description").val();$.ajax({url:api_operation,cache:!1,dataType:"json",type:"POST",data:{calling:"operation",action:"submit",id:t,name:a,description:i},error:function(t){console.log(t)}}).done(function(t){console.log(t),e(),operationList(n)})}),$("#btn-special-list").click(function(){$("#special-list").addClass("-show"),$("#filter").fadeIn(300)}),$("#caliber-search").keyup(function(){caliberList($(this).val())}),caliberList(""),$(".col-container").on("click",".btn-operation-matching",function(){r=$(this).parent().attr("data-id"),$.ajax({url:api_operation,cache:!1,dataType:"json",type:"POST",data:{calling:"operation",action:"create_macthing",route_id:n,operation_id:r},error:function(){console.log("Request Error")}}).done(function(t){console.log(t),operationList(n)})}),$(".col-container").on("click",".btn-operation-unmatch",function(){r=$(this).parent().attr("data-id"),$.ajax({url:api_operation,cache:!1,dataType:"json",type:"POST",data:{calling:"operation",action:"remove_macthing",route_id:n,operation_id:r},error:function(){console.log("Request Error")}}).done(function(t){console.log(t),operationList(n)}).error()}),$(".col-container").on("click",".btn-caliber-edit",function(){i=$(this).parent().attr("data-id"),console.log(i),$.ajax({url:api_caliber,cache:!1,dataType:"json",type:"GET",data:{calling:"caliber",action:"get",caliber_id:i},error:function(t){console.log(t)}}).done(function(t){console.log(t),$btnSubmitCaliber.html("Save"),$dialogCaliber.fadeIn(300),$filterCaliber.fadeIn(100),$("#caliber_code").val(t.data.dataset.code),$("#caliber_family").val(t.data.dataset.family),$("#caliber_description").val(t.data.dataset.description),$("#caliber_stdtime").val(t.data.dataset.standard_hrs),$("#caliber_id").val(t.data.dataset.id)})}),$(".col-container").on("click",".btn-caliber-enable",function(){i=$(this).parent().attr("data-id"),o=$(this).parent().children(".detail").children(".name").html();var t=confirm("Are you sure you want set this "+o+" to Active ?");return t?($.ajax({url:api_caliber,cache:!1,dataType:"json",type:"POST",data:{calling:"caliber",action:"setActive",caliber_id:i},error:function(){console.log("Request Error")}}).done(function(t){console.log(t),caliberList("")}),void 0):!1}),$(".col-container").on("click",".btn-route-enable",function(){n=$(this).parent().attr("data-id"),route_name=$(this).parent().children(".detail").children(".name").html();var t=confirm("Are you sure you want set "+route_name+" to primary route in "+o+" ?");return t?($.ajax({url:api_route,cache:!1,dataType:"json",type:"POST",data:{calling:"route",action:"set_primary",route_id:n,caliber_id:i},error:function(){console.log("Request Error")}}).done(function(t){console.log(t),routeList(i)}).error(),void 0):!1}),$(".col-container").on("click",".btn-route-edit",function(){n=$(this).parent().attr("data-id"),$.ajax({url:api_route,cache:!1,dataType:"json",type:"GET",data:{calling:"route",action:"get",route_id:n},error:function(){console.log("Request Error")}}).done(function(t){console.log(t),$btnSubmitRoute.html("Save"),$dialogRoute.fadeIn(300),$filterRoute.fadeIn(100),$("#route_id").val(t.data.dataset.id),$("#route_name").val(t.data.dataset.name),$("#route_description").val(t.data.dataset.description)}).error()}),$(".col-container").on("click",".btn-operation-edit",function(){r=$(this).parent().attr("data-id"),$.ajax({url:api_operation,cache:!1,dataType:"json",type:"GET",data:{calling:"operation",action:"get",operation_id:r},error:function(t){console.log(t)}}).done(function(t){console.log(t),$btnSubmitOperation.html("Save"),$dialogOperation.fadeIn(300),$filterOperation.fadeIn(100),$("#operation_id").val(t.data.dataset.id),$("#operation_name").val(t.data.dataset.name),$("#operation_description").val(t.data.dataset.description)}).error()}),$(".col-container").on("click",".caliber-items",function(){i=$(this).attr("data-id"),o=$(this).children(".detail").children(".name").html(),$(".caliber-items").removeClass("-active"),$(this).addClass("-active"),console.clear(),console.log("caliber",i),$("#operation_list").html('<div class="intro">OPERATION</div>'),routeList(i)}),$(".col-container").on("click",".route-items",function(){n=$(this).attr("data-id"),$(".route-items").removeClass("-active"),$(this).addClass("-active"),console.clear(),console.log("caliber",i),console.log("route",n),operationList(n)})});